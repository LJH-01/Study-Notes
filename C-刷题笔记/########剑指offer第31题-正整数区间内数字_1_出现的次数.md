# ########剑指offer第31题-正整数区间内数字 1 出现的次数

## 题目描述

求出1~13的整数中1出现的次数,并算出100~1300的整数中1出现的次数？为此他特别数了一下1~13中包含1的数字有1、10、11、12、13因此共出现6次,但是对于后面问题他就没辙了。ACMer希望你们帮帮他,并把问题更加普遍化,可以很快的求出任意非负整数区间中1出现的次数（从1 到 n 中1出现的次数）。

---

这是一道纯数学题，我的方法不足取，直接用StringBuffer append(int i)，然后遍历字符串，这样当数字很大时，append函数会内存溢出。

稍微改进是 对每个数字不按照字符串来处理，按照取模，看是否有1，这样内存不会溢出，但是时间复杂度有点高

最好的方法是数学的方法，需要深入的分析：

[https://www.cnblogs.com/cyjb/p/digitOccurrenceInRegion.html](https://www.cnblogs.com/cyjb/p/digitOccurrenceInRegion.html)

---

接下来以 n=2593,X=5为例来解释如何得到数学公式。

从 1 至 2593 中，数字 5 总计出现了 813 次，其中有 259 次出现在个位，260 次出现在十位，294 次出现在百位，0 次出现在千位。

1. 现在依次分析这些数据，首先是个位。从 1 至 2590 中，包含了 259 个 10，因此任意的 X 都出现了 259 次。最后剩余的三个数 2591, 2592 和 2593，因为它们最大的个位数字 3 < X，因此不会包含任何 5。

2. 然后是十位。从 1 至 2500 中，包含了 25 个 100，因此任意的 X 都出现了 25×10=250次。剩下的数字是从 2501 至 2593，它们最大的十位数字 9 > X，因此会包含全部 10 个 5。最后总计 250 + 10 = 260。

3. 接下来是百位。从 1 至 2000 中，包含了 2 个 1000，因此任意的 X 都出现了 2×100=200次。剩下的数字是从 2001 至 2593，它们最大的百位数字 5 == X，这时情况就略微复杂，它们的百位肯定是包含 5 的，但不会包含全部 100 个。如果把百位是 5 的数字列出来，是从 2500 至 2593，数字的个数与百位和十位数字相关，是 93+1 = 94。最后总计 200 + 94 = 294。

4. 最后是千位。现在已经没有更高位，因此直接看最大的千位数字 2 < X，所以不会包含任何 5。到此为止，已经计算出全部数字 5 的出现次数。

总结一下以上的算法，可以看到，

当计算右数第 i位包含的 X 的个数时：

取第 i位左边（高位）的数字，乘以 10i−1，得到基础值 a。

取第 i位数字，计算修正值：

如果大于 X，则结果为 a+10i−1。

如果小于 X，则结果为 a。

如果等 X，则取第 i位右边（低位）数字，设为 b，最后结果为 a+b+1。

相应的代码非常简单，效率也非常高，时间复杂度只有 O(log10n)。

---

当X=0时还要另行考虑
